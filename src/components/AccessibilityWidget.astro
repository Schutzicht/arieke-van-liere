---
---

<div id="a11y-widget" class="fixed bottom-4 left-4 z-50 font-sans">
    <!-- Menu (Hidden by default) -->
    <div id="a11y-menu" class="hidden mb-4 bg-white rounded-2xl shadow-2xl border border-gray-200 w-64 overflow-hidden transform transition-all duration-300 origin-bottom-left scale-90 opacity-0">
        <div class="bg-gray-100 px-4 py-3 border-b border-gray-200 flex justify-between items-center">
            <h3 class="font-bold text-gray-900 text-sm">Toegankelijkheid</h3>
            <button id="close-a11y" class="text-gray-500 hover:text-gray-900 p-1">
                <span class="sr-only">Sluiten</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
        </div>
        
        <div class="p-2 space-y-1">
            <!-- Contrast Toggle -->
            <button id="toggle-contrast" class="w-full flex items-center justify-between px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors group">
                <div class="flex items-center gap-3">
                    <div class="w-8 h-8 rounded-full bg-gray-900 text-white flex items-center justify-center group-hover:scale-110 transition-transform">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M12 2a10 10 0 0 1 10 10 10 10 0 0 1-10 10V2z"></path></svg>
                    </div>
                    <span class="text-sm font-medium text-gray-700">Contrast</span>
                </div>
                <div class="w-10 h-5 bg-gray-200 rounded-full relative transition-colors toggle-track">
                    <div class="w-3 h-3 bg-white rounded-full absolute top-1 left-1 transition-transform toggle-thumb shadow-sm"></div>
                </div>
            </button>

            <!-- Text Size Toggle -->
            <button id="toggle-text" class="w-full flex items-center justify-between px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors group">
                <div class="flex items-center gap-3">
                    <div class="w-8 h-8 rounded-full bg-gray-900 text-white flex items-center justify-center group-hover:scale-110 transition-transform">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19V5h6m7 14V9h-6"></path></svg>
                    </div>
                    <span class="text-sm font-medium text-gray-700">Tekstgrootte</span>
                </div>
                <div class="w-10 h-5 bg-gray-200 rounded-full relative transition-colors toggle-track">
                    <div class="w-3 h-3 bg-white rounded-full absolute top-1 left-1 transition-transform toggle-thumb shadow-sm"></div>
                </div>
            </button>

            <!-- Motion Toggle -->
            <button id="toggle-motion" class="w-full flex items-center justify-between px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors group">
                <div class="flex items-center gap-3">
                    <div class="w-8 h-8 rounded-full bg-gray-900 text-white flex items-center justify-center group-hover:scale-110 transition-transform">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="4.93" y1="4.93" x2="19.07" y2="19.07"></line></svg>
                    </div>
                    <span class="text-sm font-medium text-gray-700">Stop Animatie</span>
                </div>
                <div class="w-10 h-5 bg-gray-200 rounded-full relative transition-colors toggle-track">
                    <div class="w-3 h-3 bg-white rounded-full absolute top-1 left-1 transition-transform toggle-thumb shadow-sm"></div>
                </div>
            </button>
        </div>
    </div>

    <!-- Toggle Button -->
    <button id="a11y-trigger" class="w-12 h-12 bg-white text-brand-green border-2 border-brand-green rounded-full shadow-lg flex items-center justify-center hover:scale-110 hover:bg-brand-green hover:text-white transition-all duration-300 focus:outline-none focus:ring-4 focus:ring-brand-green/30" aria-label="Toegankelijkheidsopties">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M12 8v8"></path><path d="M8 12h8"></path></svg>
    </button>
</div>

<script>
    const trigger = document.getElementById('a11y-trigger');
    const menu = document.getElementById('a11y-menu');
    const closeBtn = document.getElementById('close-a11y');
    const toggleContrast = document.getElementById('toggle-contrast');
    const toggleText = document.getElementById('toggle-text');
    const toggleMotion = document.getElementById('toggle-motion');

    let state = {
        contrast: localStorage.getItem('a11y_contrast') === 'true',
        text: localStorage.getItem('a11y_text') === 'true',
        motion: localStorage.getItem('a11y_motion') === 'true',
        menuOpen: false
    };

    function updateUI() {
        // Toggle Menu
        if (state.menuOpen) {
            menu?.classList.remove('hidden');
            // Small delay for transition
            setTimeout(() => {
                menu?.classList.remove('scale-90', 'opacity-0');
            }, 10);
            trigger?.classList.add('bg-brand-green', 'text-white');
        } else {
            menu?.classList.add('scale-90', 'opacity-0');
             setTimeout(() => {
                if (!state.menuOpen) menu?.classList.add('hidden');
            }, 300);
            trigger?.classList.remove('bg-brand-green', 'text-white');
        }

        // Apply HTML classes
        document.documentElement.classList.toggle('a11y-high-contrast', state.contrast);
        document.documentElement.classList.toggle('a11y-large-text', state.text);
        document.documentElement.classList.toggle('a11y-reduced-motion', state.motion);

        // Update Toggle Switch Visuals
        updateToggleVisual(toggleContrast, state.contrast);
        updateToggleVisual(toggleText, state.text);
        updateToggleVisual(toggleMotion, state.motion);
    }

    function updateToggleVisual(btn, isActive) {
        if (!btn) return;
        const track = btn.querySelector('.toggle-track');
        const thumb = btn.querySelector('.toggle-thumb');

        if (isActive) {
            track?.classList.add('bg-brand-green');
            track?.classList.remove('bg-gray-200');
            thumb?.classList.add('translate-x-5');
        } else {
            track?.classList.remove('bg-brand-green');
            track?.classList.add('bg-gray-200');
            thumb?.classList.remove('translate-x-5');
        }
    }

    // Initialize
    updateUI();

    // Event Listeners
    trigger?.addEventListener('click', () => {
        state.menuOpen = !state.menuOpen;
        updateUI();
    });

    closeBtn?.addEventListener('click', () => {
        state.menuOpen = false;
        updateUI();
    });

    toggleContrast?.addEventListener('click', () => {
        state.contrast = !state.contrast;
        localStorage.setItem('a11y_contrast', String(state.contrast));
        updateUI();
    });

    toggleText?.addEventListener('click', () => {
        state.text = !state.text;
        localStorage.setItem('a11y_text', String(state.text));
        updateUI();
    });

    toggleMotion?.addEventListener('click', () => {
        state.motion = !state.motion;
        localStorage.setItem('a11y_motion', String(state.motion));
        updateUI();
    });
</script>
